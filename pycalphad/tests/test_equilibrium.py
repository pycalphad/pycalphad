"""
The equilibrium test module verifies that the Equilibrium class produces the
correct solution for thermodynamic equilibrium.
"""

from unittest.case import SkipTest
from nose.tools import raises
from numpy.testing import assert_allclose
from pycalphad import Database, calculate, equilibrium
import pycalphad.variables as v

ALNIPT_TDB = """
$
 ELEMENT /-   ELECTRON_GAS              0.0000E+00  0.0000E+00  0.0000E+00!
 ELEMENT VA   VACUUM                    0.0000E+00  0.0000E+00  0.0000E+00!
 ELEMENT AL   FCC_A1                    2.6982E+01  4.5773E+03  2.8322E+01!
 ELEMENT NI   FCC_A1                    5.8690E+01  4.7870E+03  2.9796E+01!
 ELEMENT PT   FCC_A1                    1.9508E+02  5.7237E+03  4.1631E+01!

$$$$$$$$$$$$$$$$$XUAN

 FUNCTION VX1   298.15  -2.2745400E+04;   6000.0   N !
 FUNCTION VX2   298.15   7.5000000E-01;   6000.0   N !
 FUNCTION VX3   298.15   2.2500000E+04;   6000.0   N !
 FUNCTION VX10  298.15   4.1176252E+04;   6000.0   N !
 FUNCTION VX11  298.15  -3.3084025E+01;   6000.0   N !
 FUNCTION VX20  298.15   2.9968958E+03;   6000.0   N !
 FUNCTION VX40  298.15  -2.7046916E+05;   6000.0   N !
 FUNCTION VX41  298.15  -8.3384917E+00;   6000.0   N !
 FUNCTION VX42  298.15  -1.9293253E+04;   6000.0   N !
 FUNCTION VX43  298.15   2.4643347E+01;   6000.0   N !
 FUNCTION VX44  298.15   4.5967650E+04;   6000.0   N !
 FUNCTION VX50  298.15  -2.0570000E+05;   6000.0   N !
 FUNCTION VX51  298.15   1.2175000E+01;   6000.0   N !
 FUNCTION VX53  298.15  -5.0000000E+01;   6000.0   N !
 FUNCTION VX54  298.15   4.5000000E+04;   6000.0   N !
 FUNCTION VX85  298.15  -1.0118662E+05;   6000.0   N !
 FUNCTION VX90  298.15   6.0995004E+00;   6000.0   N !
 FUNCTION VX91  298.15   9.4351782E+00;   6000.0   N !
 FUNCTION VX92  298.15   5.2341182E+00;   6000.0   N !
 FUNCTION VX93  298.15   6.4125253E+00;   6000.0   N !
 FUNCTION VX94  298.15   6.9806493E+00;   6000.0   N !
 FUNCTION VX95  298.15   8.6920000E+00;   6000.0   N !
 FUNCTION VX96  298.15   9.3985666E+00;   6000.0   N !



 FUNCTION VX50  298.15  -2.0570000E+05;   6000.0   N !
 FUNCTION VX51  298.15   1.2175000E+01;   6000.0   N !
 FUNCTION VX53  298.15  -5.0000000E+01;   6000.0   N !
 FUNCTION VX54  298.15   4.5000000E+04;   6000.0   N !

 FUNCTION B2ALPT    298.15  -205700+12.18*T;   6000.0   N !
 FUNCTION LB2ALPT   298.15  -50*T;   6000.0   N !

 FUNCTION L1A2ALPT   298.15  45000;   6000.0   N !

 FUNCTION B2PTVA     298.15  B2ALVA-B2ALPT;   6000.0   N !
 FUNCTION LB2PTVA    298.15 -15000+5*T; 6000.00  N !

$$$$$$$$$$$$$$$$$$

 FUNCTION GHSERAL    2.98150E+02  -7976.15+137.093038*T-24.3671976*T*LN(T)
     -.001884662*T**2-8.77664E-07*T**3+74092*T**(-1);  7.00000E+02  Y
      -11276.24+223.048446*T-38.5844296*T*LN(T)+.018531982*T**2
     -5.764227E-06*T**3+74092*T**(-1);  9.33600E+02  Y
      -11278.378+188.684153*T-31.748192*T*LN(T)-1.231E+28*T**(-9);
     6.00000E+03  N !
 FUNCTION GBCCAL     2.98150E+02  +10083-4.813*T+GHSERAL#;   6.00000E+03  N !
 FUNCTION GALBCC     298.15  +10083-4.813*T+GHSERAL#;   6000.0   N
     !
 FUNCTION GLIQAL     2.98140E+02  +11005.029-11.841867*T+7.934E-20*T**7
     +GHSERAL#;  9.33590E+02  Y
      +10482.282-11.253974*T+1.231E+28*T**(-9)+GHSERAL#;  6.00000E+03  N !

 FUNCTION GHSERNI    2.98150E+02  -5179.159+117.854*T-22.096*T*LN(T)
     -.0048407*T**2;  1.72800E+03  Y
      -27840.655+279.135*T-43.1*T*LN(T)+1.12754E+31*T**(-9); 6.00000E+03  N !
 FUNCTION GBCCNI     2.98150E+02  +8715.084-3.556*T+GHSERNI#; 6.00000E+03 N !

 FUNCTION GHSERPT    2.98150E+02  -7595.631+124.388276*T-24.5526*T*LN(T)
     -.00248297*T**2-2.0138E-08*T**3+7974*T**(-1);  1.30000E+03  Y
      -9253.174+161.529616*T-30.2527*T*LN(T)+.002321665*T**2
     -6.56947E-07*T**3-272106*T**(-1);  2.04210E+03  Y
      -222518.973+1021.21087*T-136.422689*T*LN(T)+.020501692*T**2
     -7.60985E-07*T**3+71709819*T**(-1);  4.00000E+03  N !
 FUNCTION GBCCPT     2.98150E+02  +15000-2.4*T+GHSERPT#;   6.00000E+03   N!
 FUNCTION GPTBCC     298.15  +15000-2.4*T+GHSERPT#;  4.00000E+03  N !

 FUNCTION VA1  298.15    2.00000000E+05;,, N 05LU !
$$FUNCTION VA31 298.15    3.00000000E+04;,, N 05LU !

$$FUNCTION VA31 298.15    30000;,, N 05LU !
$$FUNCTION VA33 298.15    30000;,, N 05LU !
$$FUNCTION VA35 298.15    30000;,, N 05LU !

$$$$$$GAL2NIPT
 FUNCTION VA40 298.15   0;,, N 05LU !
$$$$$$GNI2ALPT
 FUNCTION VA42 298.15   0;,, N 05LU !
$$$$$$GPT2ALNI
 FUNCTION VA44 298.15   0;,, N 05LU !

$$$$$$LALNIALPT
 FUNCTION VA46 298.15    0;,, N 05LU !
$$$$$$LALNINIPT
 FUNCTION VA48 298.15    0;,, N 05LU !
$$$$$$LALPTNIPT
 FUNCTION VA50 298.15    0;,, N 05LU !




$$$THIS SET IS LIKE CALPHAD PAPER
$$FUNCTION VA42 298.15   +3000;,, N 05LU !
$$FUNCTION VA44 298.15   -3000;,, N 05LU !



$$FUNCTION VA70 298.15   -5.00000000E+04;,, N 05LU !
$$FUNCTION VA71 298.15    1.0e1;,, N 05LU !

FUNCTION VA70 298.15   -55000;,, N 05LU !
FUNCTION VA71 298.15    1.0;,, N 05LU !

FUNCTION VA76 298.15    7.00000000E+03;,, N 05LU !
FUNCTION VA77 298.15    2.00000000E+03;,, N 05LU !
FUNCTION VA78 298.15   -9.50000000E+04;,, N 05LU !
FUNCTION VA79 298.15    6.00000000E+00;,, N 05LU !
FUNCTION VA85 298.15   -4.50000000E+04;,, N 05LU !
FUNCTION VA86 298.15   0.0;,, N 05LU !
FUNCTION VA87 298.15   -5.00000000E+03;,, N 05LU !
FUNCTION VA88 298.15   0.0;,, N 05LU !
FUNCTION VA89 298.15   0.0;,, N 05LU !
FUNCTION VA90 298.15   0.0;,, N 05LU !
FUNCTION VA91 298.15   -9.80000000E+04;,, N 05LU !
FUNCTION VA92 298.15    6.00000000E+00;,, N 05LU !
FUNCTION VA93 298.15   -2.00000000E+04;,, N 05LU !
FUNCTION VA95 298.15    1.00000000E+05;,, N 05LU !
FUNCTION VA97 298.15    0.0;,, N 05LU !
FUNCTION VA98 298.15    0.0;,, N 05LU !
FUNCTION VA99 298.15    0.0;,, N 05LU !

FUNCTION VA2 298.15    0.0;,, N 05LU !
FUNCTION VA3 298.15    0.0;,, N 05LU !
FUNCTION VA4 298.15    0.0;,, N 05LU !
FUNCTION VA5 298.15    0.0;,, N 05LU !
FUNCTION VA6 298.15    0.0;,, N 05LU !
FUNCTION VA32 298.15    0.0;,, N 05LU !
FUNCTION VA33 298.15    0.0;,, N 05LU !
FUNCTION VA34 298.15    0.0;,, N 05LU !
FUNCTION VA35 298.15    0.0;,, N 05LU !
FUNCTION VA36 298.15    0.0;,, N 05LU !
FUNCTION VA74 298.15    0.0;,, N 05LU !
FUNCTION VA75 298.15    0.0;,, N 05LU !
FUNCTION VA80 298.15    0.0;,, N 05LU !
FUNCTION VA81 298.15    0.0;,, N 05LU !
FUNCTION VA60 298.15    0.0;,, N 05LU !
FUNCTION VA61 298.15    0.0;,, N 05LU !
FUNCTION VA62 298.15    0.0;,, N 05LU !
FUNCTION VA63 298.15    0.0;,, N 05LU !
FUNCTION VA64 298.15    0.0;,, N 05LU !
FUNCTION VA65 298.15    0.0;,, N 05LU !
FUNCTION VA66 298.15    0.0;,, N 05LU !
FUNCTION VA67 298.15    0.0;,, N 05LU !
FUNCTION VA72 298.15    0.0;,, N 05LU !
FUNCTION VA73 298.15    0.0;,, N 05LU !
FUNCTION VA94 298.15    0.0;,, N 05LU !
FUNCTION VA96 298.15    0.0;,, N 05LU !

 FUNCTION LLIQ2      298.15  +81204.81-31.95713*T;,,   N 95DUP3 !
 FUNCTION LLIQ3      298.15  +4365.35-2.51632*T;,,   N 95DUP3 !
 FUNCTION LLIQ4      298.15  -22101.64+13.16341*T;,,   N 95DUP3 !
 FUNCTION LLIQ0      298.15  -5*LLIQ2-9*LLIQ4;,,   N 95DUP3 !
 FUNCTION LLIQ1      298.15  -7*UNTIER*LLIQ3;,,   N 95DUP3 !
 FUNCTION DEUX       298.15  2;,,   N 95DUP3 !
 FUNCTION UNSURDEU   298.15  +DEUX**(-1);,,   N 95DUP3 !
 FUNCTION GB2NINI    298.15  +GBCCNI;,,   N 95DUP3 !
 FUNCTION GB2ALVA    298.15  +5000-.5*T+UNSURDEU*GBCCAL;,,  N 95DUP3 !
 FUNCTION GB2ALNI    298.15  -76198.65+13.202875*T
                             +UNSURDEU*GBCCAL+UNSURDEU*GBCCNI;,, N 95DUP3 !
 FUNCTION GB2NIVA    298.15  -GB2ALNI+GB2NINI+GB2ALVA;,,  N 95DUP3 !
 FUNCTION SIX        298.15  6;,,   N 95DUP3 !
 FUNCTION UNSURSIX   298.15  +SIX**(-1);,,   N 95DUP3 !
 FUNCTION GALALVA    298.15  +5000-.5*T+5*UNSURSIX*GBCCAL;,,  N 95DUP3 !
 FUNCTION GALNINI    298.15  +5000+GB2ALNI;,,   N 95DUP3 !
 FUNCTION GALNIVA    298.15  -59620.987+11.387*T
                     +3*UNSURSIX*GBCCAL+2*UNSURSIX*GBCCNI;,, N 95DUP3 !
 FUNCTION GALALNI    298.15  -GALNIVA+GALALVA+GALNINI;,,     N 95DUP3 !
 FUNCTION L32ALNI    298.15  -32247.363+21.965*T;,,   N 95DUP3 !
 FUNCTION L32NIVA    298.15  -3666.95+1.1722*T;,,   N 95DUP3 !
 FUNCTION U1ALNI     298.15  -13415.515+2.0819247*T;,,   N 95DUP3 !

 FUNCTION UALNI      298.15  -43590+6.22*T;,,   N 03SUN !
 FUNCTION ALPHA      298.15  -29600;,,   N 03SUN !
 FUNCTION BETA       298.15  -66718+11.64*T;,,   N 03SUN !
 FUNCTION AL3NI      298.15  ALPHA;,,   N 03SUN !
 FUNCTION AL2NI2     298.15  BETA;,,    N 03SUN !
 FUNCTION ALNI3      298.15  UALNI;,,   N 03SUN !

 FUNCTION URALNI     298.15  -34575+13.22*T;,,   N 03SUN !

 FUNCTION LFCC0      298.15  +AL3NI+1.5*AL2NI2+ALNI3+1.5*URALNI;,,  N 03SUN !
 FUNCTION LFCC1      298.15  +2*AL3NI-2*ALNI3;,,   N 03SUN !
 FUNCTION LFCC2      298.15  +AL3NI-1.5*AL2NI2+ALNI3-1.5*URALNI;,,  N 03SUN !
 FUNCTION LFCC3      298.15 0.0; 6000.00  N 03SUN !
 FUNCTION U3ALNI     298.15 0.0; 6000.00  N 03SUN !

 FUNCTION L0ALNI     298.15  5310-1.46*T;,,   N !
 FUNCTION UN_ASS 298.15 0; 300 N !

$****AL-PT
$ FUNCTION UAB        298.15  -13595+8.3*T;   6000   N !
$ FUNCTION UPT3AL     298.15  +3*UAB#-3913;   6000   N !
$ FUNCTION UALPT      298.15  +4*UAB#;   6000   N !
$ FUNCTION UALPT3     298.15  +3*UAB#;   6000   N !
$ FUNCTION UL0        298.15  +1412.8+5.7*T;   6000   N !
$ FUNCTION USRO       298.15  +UAB#;   6000   N !
$ FUNCTION ULD0       298.15  -110531-22.9*T;   6000   N !
$ FUNCTION ULD1       298.15  -25094;   6000   N !
$ FUNCTION ULD2       298.15  +21475;   6000   N !
$ FUNCTION DG0        298.15  +UALPT3#+1.5*UALPT#+UPT3AL#;   6000
$       N !
$ FUNCTION DG1        298.15  +2*UALPT3#-2*UPT3AL#;   6000   N !
$ FUNCTION DG2        298.15  +UALPT3#-1.5*UALPT#+UPT3AL#;   6000
$       N !

 FUNCTION APL0FCC    2.98150E+02  +41176.252-33.084025*T;   6.00000E+03   N !
 FUNCTION APL1FCC    298.15  0;   6000 N !
 FUNCTION APL2FCC    298.15  0;   6000 N !
 FUNCTION APL3FCC    298.15  0;   6000 N !

 FUNCTION RAL3PT1     2.98150E+02  +3*UALPT#+APALP#;   6.00000E+03   N !
 FUNCTION RAL2PT2    2.98150E+02  +4*UALPT#;   6.00000E+03   N !
 FUNCTION RAL1PT3     2.98150E+02  +3*UALPT#+APBET#;   6.00000E+03   N !
 FUNCTION UALPT      2.98150E+02  -22745.4+0.75*T;   6.00000E+03   N !
 FUNCTION RECALPT    2.98150E+02  0;   6.00000E+03   N !

 FUNCTION APALP      2.98150E+02  +22500;   6.00000E+03   N !
 FUNCTION APBET       2.98150E+02  0;   6.00000E+03   N !

 FUNCTION GAL3PT1  298.15 RAL3PT1-0.1875*APL0FCC-0.09375*APL1FCC
     -0.046875*APL2FCC-0.0234375*APL3FCC; 6000 N !
 FUNCTION GAL2PT2  298.15 RAL2PT2-0.25*APL0FCC; 6000 N !
 FUNCTION GAL1PT3  298.15 RAL1PT3-0.1875*APL0FCC+0.09375*APL1FCC
     -0.046875*APL2FCC+0.0234375*APL3FCC; 6000 N !

 FUNCTION ALPTG0     2.98150E+02  +GAL3PT1#+1.5*GAL2PT2#+GAL1PT3#;
     6.00000E+03   N !
 FUNCTION ALPTG1     2.98150E+02  +2*GAL3PT1#-2*GAL1PT3#;   6.00000E+03   N !
 FUNCTION ALPTG2     2.98150E+02  +GAL3PT1#-1.5*GAL2PT2#+GAL1PT3#;
     6.00000E+03   N !

 FUNCTION UL0 298.15  0;   6000   N !
 FUNCTION UL1        2.98150E+02  2996.8958;   6.00000E+03   N !

$ UAP only used in ternary
 FUNCTION UAP 298.15  +UALPT;   6000   N !
 FUNCTION REC       2.98150E+02  +UALPT#+RECALPT#;   6.00000E+03   N !

$*****NI-PT
 FUNCTION L0FCC    298.15  27500+10.977*T;   6000 N !
 FUNCTION L1FCC    298.15  -6500;   6000 N !
 FUNCTION L2FCC    298.15  0;   6000 N !
 FUNCTION L3FCC    298.15  0;   6000 N !

 FUNCTION RNI3PT1  298.15 -1.09000000E+04; 6000 N !
 FUNCTION RNI2PT2  298.15 -1.35000000E+04-0.5*T; 6000 N !
 FUNCTION RNI1PT3  298.15 -8.30000000E+03-0.5*T; 6000 N !

 FUNCTION GNI3PT1  298.15 RNI3PT1-0.1875*L0FCC-0.09375*L1FCC
     -0.046875*L2FCC-0.0234375*L3FCC; 6000 N !
 FUNCTION GNI2PT2  298.15 RNI2PT2-0.25*L0FCC; 6000 N !
 FUNCTION GNI1PT3  298.15 RNI1PT3-0.1875*L0FCC+0.09375*L1FCC
     -0.046875*L2FCC+0.0234375*L3FCC; 6000 N !

 FUNCTION NIPTG0     2.98150E+02  +GNI3PT1#+1.5*GNI2PT2#+GNI1PT3#;
     6.00000E+03   N !
 FUNCTION NIPTG1     2.98150E+02  +2*GNI3PT1#-2*GNI1PT3#;   6.00000E+03   N !
 FUNCTION NIPTG2     2.98150E+02  +GNI3PT1#-1.5*GNI2PT2#+GNI1PT3#;
     6.00000E+03   N !

 FUNCTION RECNINI  298.15 -3.67000000E+03; 6000 N !
 FUNCTION RECNIPT  298.15 -3.25000000E+03; 6000 N !
 FUNCTION RECPTPT  298.15 -2.73000000E+03; 6000 N !

$*****NI-AL-PT
 FUNCTION TROIS      2.98150E+02  3;   6.00000E+03   N !
 FUNCTION UNTIER     2.98150E+02  +TROIS#**(-1);   6.00000E+03   N !
 FUNCTION GNIPT 298.15 GNI3PT1#*UNTIER#; 6000 N !
 FUNCTION GAL2NIPT 298.15 2*UAP#+2*U1ALNI#+GNIPT#+VA40+VA41*T; 6000 N !
 FUNCTION GNI2ALPT 298.15 2*U1ALNI#+2*GNIPT#+UAP#+VA42+VA43*T; 6000 N !
 FUNCTION GPT2ALNI 298.15 2*GNIPT#+2*UAP#+U1ALNI#+VA44+VA45*T; 6000 N !
 FUNCTION LALNIALPT 298.15 0.5*U1ALNI+0.5*UAP-0.5*GNIPT+VA46+VA47*T; 6000 N !
 FUNCTION LALNINIPT 298.15 0.5*U1ALNI-0.5*UAP+0.5*GNIPT+VA48+VA49*T; 6000 N !
 FUNCTION LALPTNIPT 298.15 -0.5*U1ALNI+0.5*UAP+0.5*GNIPT+VA50+VA51*T; 6000 N !
$***************

 TYPE_DEFINITION % SEQ *!
$ DEFINE_SYSTEM_DEFAULT ELEMENT 4 !
 DEFAULT_COMMAND DEF_SYS_ELEMENT VA !


$******************************** Liquid

 PHASE LIQUID:L %  1  1.0  !
    CONSTITUENT LIQUID:L :AL,NI,PT :  !

   PARAMETER G(LIQUID,AL;0)  2.98150E+02  +11005.029-11.841867*T
      +7.934E-20*T**7+GHSERAL#;  9.33600E+02  Y
      +10482.282-11.253974*T+1.231E+28*T**(-9)+GHSERAL#;  6.00000E+03  N
      91DIN !
   PARAMETER G(LIQUID,NI;0)  2.98130E+02  +16414.686-9.397*T
      -3.82318E-21*T**7+GHSERNI#;  1.72800E+03  Y
      +18290.88-10.537*T-1.12754E+31*T**(-9)+GHSERNI#;  6.00E+03  N 91DIN !
   PARAMETER G(LIQUID,PT;0)  2.98150E+02  +12520.614+115.114727*T
      -24.5526*T*LN(T)-.00248297*T**2-2.0138E-08*T**3+7974*T**(-1); 6.0E+02
       Y
    +19019.913+33.017485*T-12.351404*T*LN(T)-.011543133*T**2+9.30579E-07*T**3
      -600885*T**(-1);  2.04210E+03  Y
      +1404.968+205.861909*T-36.5*T*LN(T);  4.00000E+03  N REF283 !

   PARAMETER L(LIQUID,AL,NI;0)  298.15  +LLIQ0;,,   N 95DUP3 !
   PARAMETER L(LIQUID,AL,NI;1)  298.15  +LLIQ1;,,   N 95DUP3 !
   PARAMETER L(LIQUID,AL,NI;2)  298.15  +LLIQ2;,,   N 95DUP3 !
   PARAMETER L(LIQUID,AL,NI;3)  298.15  +LLIQ3;,,   N 95DUP3 !
   PARAMETER L(LIQUID,AL,NI;4)  298.15  +LLIQ4;,,   N 95DUP3 !

  PARAMETER L(liquid,ni,pt;0) 2.98150E+02 -4.07756E+04;
         6.00000E+03 N 05LU !
  PARAMETER L(liquid,ni,pt;1) 2.98150E+02 -5.5E+03; 6.00000E+03 N 05LU !
  PARAMETER L(liquid,ni,pt;2) 2.98150E+02 3.50E+03; 6.00000E+03 N 05LU !

  PARAMETER L(liquid,al,ni,pt;0) 2.98150E+02 +VA1+VA2*T;
        6.00000E+03 N 05LU !
  PARAMETER L(liquid,al,ni,pt;1) 2.98150E+02 +VA3+VA4*T;
      6.00000E+03 N 05LU !
  PARAMETER L(liquid,al,ni,pt;2) 2.98150E+02 +VA5+VA6*T;
      6.00000E+03 N 05LU !

   PARAMETER G(LIQUID,AL,PT;0)  298.15  +VX40#+VX41#*T;   6000.0   N
  REF0 !
   PARAMETER G(LIQUID,AL,PT;1)  298.15  +VX42#+VX43#*T;   6000.0   N
  REF0 !
   PARAMETER G(LIQUID,AL,PT;2)  298.15  +VX44#+VX45#*T;   6000.0   N
  REF0 !
   PARAMETER G(LIQUID,AL,PT;3)  298.15  +VX46#+VX47#*T;   6000.0   N
  REF0 !

$*********************  FCC_A1

 TYPE_DEFINITION ( GES A_P_D FCC_A1 MAGNETIC  -3.0    2.80000E-01 !
 PHASE FCC_A1  %(  2 1   1 !
    CONSTITUENT FCC_A1  :AL,NI%,PT : VA% :  !

   PARAMETER G(FCC_A1,AL:VA;0)  2.98150E+02  +GHSERAL#;  6.00000E+03  N
     91DIN !
   PARAMETER G(FCC_A1,NI:VA;0)  2.98150E+02  +GHSERNI#;  6.00000E+03  N
     91DIN !
   PARAMETER G(FCC_A1,PT:VA;0)  2.98150E+02  +GHSERPT#;  4.00000E+03  N
  REF283 !
$   PARAMETER TC(FCC_A1,PT:VA;0)  2.98150E+02  -307.85;   6.00000E+03
$   N REF: 0 !
   PARAMETER TC(FCC_A1,NI:VA;0)  2.98150E+02  633;   6.00000E+03   N 89DIN !
   PARAMETER BMAGN(FCC_A1,NI:VA;0)  2.98150E+02  .52;   6.00000E+03 N 89DIN !
$  PARAMETER L(fcc_a1,al,pt:va;0) 2.98150E+02 -262446.89; 2.90000E+03 N !
$  PARAMETER L(fcc_a1,al,pt:va;1) 2.9815E+02 102728.95-8.57*T; 2.90000E+03 N
$     REF01!
   PARAMETER TC(FCC_A1,AL,NI:VA;0)  2.98150E+02  -1112;   6.00000E+03   N
  95DUP3   !
   PARAMETER TC(FCC_A1,AL,NI:VA;1)  2.98150E+02  1745;   6.00000E+03   N
  95DUP3   !

   PARAMETER L(FCC_A1,AL,NI:VA;0)  298.15  +LFCC0+4*L0ALNI;,, N  03SUN !
   PARAMETER L(FCC_A1,AL,NI:VA;1)  298.15  +LFCC1;,,          N  03SUN !
   PARAMETER L(FCC_A1,AL,NI:VA;2)  298.15  +LFCC2;,,          N  03SUN !
   PARAMETER L(FCC_A1,AL,NI:VA;3)  298.15  +LFCC3;,,          N  03SUN !

  PARAMETER L(fcc_a1,ni,pt:va;0) 2.98150E+02 +L0FCC+NIPTG0+0.375*RECNINI
      +0.75*RECNIPT#+0.375*RECPTPT#; 6.00000E+03 N 05LU !
  PARAMETER L(fcc_a1,ni,pt:va;1) 2.98150E+02 +L1FCC+NIPTG1+0.75*RECNINI#
      -0.75*RECPTPT#; 6.00000E+03 N 05LU !
  PARAMETER L(fcc_a1,ni,pt:va;2) 2.98150E+02 +L2FCC+NIPTG2-1.5*RECNIPT#;
      6.00000E+03 N 05LU !
  PARAMETER L(fcc_a1,ni,pt:va;3) 2.98150E+02 +L3FCC-0.75*RECNINI#
      +0.75*RECPTPT#; 6.00000E+03 N 05LU !
  PARAMETER L(fcc_a1,ni,pt:va;4) 2.98150E+02 -0.375*RECNINI#+0.75*RECNIPT#
      -0.375*RECPTPT#; 6.0E+03 N 05LU !

  PARAMETER L(fcc_a1,al,ni,pt:va;0) 2.98150E+02 +VA31+VA32*T;
    6.00000E+03 N 05LU !
  PARAMETER L(fcc_a1,al,ni,pt:va;1) 2.98150E+02 +VA33+VA34*T;
    6.00000E+03 N 05LU !
  PARAMETER L(fcc_a1,al,ni,pt:va;2) 2.98150E+02 +VA35+VA36*T;
    6.00000E+03 N 05LU !

   PARAMETER G(FCC_A1,AL,PT:VA;0)  298.15  +APL0FCC#+ALPTG0#+1.5*REC#;
  6000   N REF0 !
   PARAMETER G(FCC_A1,AL,PT:VA;1)  298.15  +APL1FCC#+ALPTG1#;   6000   N
  REF0 !
   PARAMETER G(FCC_A1,AL,PT:VA;2)  298.15  +APL2FCC#+ALPTG2#-1.5*REC#;
  6000   N REF0 !
   PARAMETER G(FCC_A1,AL,PT:VA;3)  298.15  +APL3FCC#;
  6000   N REF0 !


$************FCC_L12
 TYPE_DEFINITION * GES AMEND_PHASE_DESCRIPTION FCC_L12 DIS_PART FCC_A1,,,!
$ TYPE_DEFINITION M GES A_P_D FCC_L12 C_S 2 NI:NI:NI:PT:VA !
$ TYPE_DEFINITION P GES A_P_D FCC_L12 C_S 3 NI:NI:PT:PT:VA !
$ TYPE_DEFINITION Q GES A_P_D FCC_L12 C_S 4 NI:PT:PT:PT:VA !
 PHASE FCC_L12  %*  5 .25 .25 .25 .25   1 !
    CONSTITUENT FCC_L12  :AL,NI,PT:AL,NI,PT:AL,NI,PT:AL,NI,PT:VA%:  !

       PARA G(FCC_L12,AL:AL:AL:AL:VA;0) 298.15 0; 6000 N!
       PARA G(FCC_L12,NI:NI:NI:NI:VA;0) 298.15 0; 6000 N!
       PARA G(FCC_L12,PT:PT:PT:PT:VA;0) 298.15 0; 6000 N!

   PARAMETER G(FCC_L12,NI:AL:AL:AL:VA;0)  298.15  +AL3NI;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:NI:AL:AL:VA;0)  298.15  +AL3NI;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,NI:NI:AL:AL:VA;0)  298.15  +AL2NI2; ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:AL:NI:AL:VA;0)  298.15  +AL3NI;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,NI:AL:NI:AL:VA;0)  298.15  +AL2NI2; ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:NI:NI:AL:VA;0)  298.15  +AL2NI2; ,,   N 03SUN !
   PARAMETER G(FCC_L12,NI:NI:NI:AL:VA;0)  298.15  +ALNI3;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:AL:AL:NI:VA;0)  298.15  +AL3NI;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,NI:AL:AL:NI:VA;0)  298.15  +AL2NI2; ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:NI:AL:NI:VA;0)  298.15  +AL2NI2; ,,   N 03SUN !
   PARAMETER G(FCC_L12,NI:NI:AL:NI:VA;0)  298.15  +ALNI3;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:AL:NI:NI:VA;0)  298.15  +AL2NI2; ,,   N 03SUN !
   PARAMETER G(FCC_L12,NI:AL:NI:NI:VA;0)  298.15  +ALNI3;  ,,   N 03SUN !
   PARAMETER G(FCC_L12,AL:NI:NI:NI:VA;0)  298.15  +ALNI3;  ,,   N 03SUN !

   PARAMETER G(FCC_L12,PT:AL:AL:AL:VA;0)  298.15  +GAL3PT1#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:PT:AL:AL:VA;0)  298.15  +GAL3PT1#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,PT:PT:AL:AL:VA;0)  298.15  +GAL2PT2#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:AL:PT:AL:VA;0)  298.15  +GAL3PT1#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,PT:AL:PT:AL:VA;0)  298.15  +GAL2PT2#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:PT:PT:AL:VA;0)  298.15  +GAL2PT2#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,PT:PT:PT:AL:VA;0)  298.15  +GAL1PT3#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:AL:AL:PT:VA;0)  298.15  +GAL3PT1#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,PT:AL:AL:PT:VA;0)  298.15  +GAL2PT2#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:PT:AL:PT:VA;0)  298.15  +GAL2PT2#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,PT:PT:AL:PT:VA;0)  298.15  +GAL1PT3#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:AL:PT:PT:VA;0)  298.15  +GAL2PT2#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,PT:AL:PT:PT:VA;0)  298.15  +GAL1PT3#;
	3000  N  REF0 !
   PARAMETER G(FCC_L12,AL:PT:PT:PT:VA;0)  298.15  +GAL1PT3#;
	3000  N  REF0 !

   PARAMETER G(FCC_L12,PT:NI:NI:NI:VA;0)  2.98150E+02  +GNI3PT1#;
6.0E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:NI:NI:VA;0)  2.98150E+02  +GNI3PT1#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:PT:NI:NI:VA;0)  2.98150E+02  +GNI2PT2#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:NI:PT:NI:VA;0)  2.98150E+02  +GNI3PT1#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:PT:NI:VA;0)  2.98150E+02  +GNI2PT2#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:PT:NI:VA;0)  2.98150E+02  +GNI2PT2#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:PT:PT:NI:VA;0)  2.98150E+02  +GNI1PT3#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:NI:NI:PT:VA;0)  2.98150E+02  +GNI3PT1#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:NI:PT:VA;0)  2.98150E+02  +GNI2PT2#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:NI:PT:VA;0)  2.98150E+02  +GNI2PT2#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:PT:NI:PT:VA;0)  2.98150E+02  +GNI1PT3#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:NI:PT:PT:VA;0)  2.98150E+02  +GNI2PT2#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:PT:PT:VA;0)  2.98150E+02  +GNI1PT3#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:PT:PT:VA;0)  2.98150E+02  +GNI1PT3#;
6E+03 N 05LU !

   PARAMETER G(FCC_L12,NI:NI:AL:PT:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:NI:PT:AL:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:AL:NI:PT:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:NI:AL:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:AL:PT:NI:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:AL:NI:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:PT:NI:NI:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:AL:NI:NI:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:NI:PT:NI:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:AL:NI:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:NI:NI:PT:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:NI:AL:VA;0)  2.98150E+02  +GNI2ALPT#;
6E+03 N 05LU !

   PARAMETER G(FCC_L12,AL:AL:NI:PT:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:AL:PT:NI:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:NI:AL:PT:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:PT:AL:NI:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:NI:PT:AL:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:PT:NI:AL:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:AL:AL:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:AL:AL:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:AL:PT:AL:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:AL:NI:AL:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:AL:AL:PT:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:AL:AL:NI:VA;0)  2.98150E+02  +GAL2NIPT#;
6E+03 N 05LU !

   PARAMETER G(FCC_L12,PT:PT:NI:AL:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:PT:AL:NI:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:PT:AL:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:AL:PT:NI:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:NI:AL:PT:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,PT:AL:NI:PT:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:AL:PT:PT:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:NI:PT:PT:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:AL:PT:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:PT:NI:PT:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI:PT:PT:AL:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL:PT:PT:NI:VA;0)  2.98150E+02  +GPT2ALNI#;
6E+03 N 05LU !

   PARAMETER L(FCC_L12,AL,NI:*:*:*:VA;0)  298.15  +L0ALNI;    ,,   N 03SUN !
   PARAMETER L(FCC_L12,*:AL,NI:*:*:VA;0)  298.15  +L0ALNI;    ,,   N 03SUN !
   PARAMETER L(FCC_L12,*:*:AL,NI:*:VA;0)  298.15  +L0ALNI;    ,,   N 03SUN !
   PARAMETER L(FCC_L12,*:*:*:AL,NI:VA;0)  298.15  +L0ALNI;    ,,   N 03SUN !

   PARAMETER G(FCC_L12,AL,PT:*:*:*:VA;0)  298.15  +UL0#;  3000  N REF0 !
   PARAMETER G(FCC_L12,*:AL,PT:*:*:VA;0)  298.15  +UL0#;  3000  N REF0 !
   PARAMETER G(FCC_L12,*:*:AL,PT:*:VA;0)  298.15  +UL0#;  3000  N REF0 !
   PARAMETER G(FCC_L12,*:*:*:AL,PT:VA;0)  298.15  +UL0#;  3000  N REF0 !

   PARAMETER G(FCC_L12,AL,PT:*:*:*:VA;1)  298.15  +UL1#;  3000  N REF0 !
   PARAMETER G(FCC_L12,*:AL,PT:*:*:VA;1)  298.15  +UL1#;  3000  N REF0 !
   PARAMETER G(FCC_L12,*:*:AL,PT:*:VA;1)  298.15  +UL1#;  3000  N REF0 !
   PARAMETER G(FCC_L12,*:*:*:AL,PT:VA;1)  298.15  +UL1#;  3000  N REF0 !


   PARAMETER G(FCC_L12,AL,PT:AL,PT:*:*:VA;0)  298.15  +REC#; 3000  N REF0 !
   PARAMETER G(FCC_L12,AL,PT:*:AL,PT:*:VA;0)  298.15  +REC#; 3000  N REF0 !
   PARAMETER G(FCC_L12,AL,PT:*:*:AL,PT:VA;0)  298.15  +REC#; 3000  N REF0 !
   PARAMETER G(FCC_L12,*:AL,PT:AL,PT:*:VA;0)  298.15  +REC#; 3000  N REF0 !
   PARAMETER G(FCC_L12,*:AL,PT:*:AL,PT:VA;0)  298.15  +REC#; 3000  N REF0 !
   PARAMETER G(FCC_L12,*:*:AL,PT:AL,PT:VA;0)  298.15  +REC#; 3000  N REF0 !

   PARAMETER L(FCC_L12,*:*:AL,NI:AL,NI:VA;0)  298.15  +URALNI;,,   N 03SUN !
   PARAMETER L(FCC_L12,*:AL,NI:*:AL,NI:VA;0)  298.15  +URALNI;,,   N 03SUN !
   PARAMETER L(FCC_L12,AL,NI:*:*:AL,NI:VA;0)  298.15  +URALNI;,,   N 03SUN !
   PARAMETER L(FCC_L12,*:AL,NI:AL,NI:*:VA;0)  298.15  +URALNI;,,   N 03SUN !
   PARAMETER L(FCC_L12,AL,NI:*:AL,NI:*:VA;0)  298.15  +URALNI;,,   N 03SUN !
   PARAMETER L(FCC_L12,AL,NI:AL,NI:*:*:VA;0)  298.15  +URALNI;,,   N 03SUN !

   PARAMETER G(FCC_L12,NI:NI:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNINI;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:NI,PT:NI:NI,PT:VA;0)  2.98150E+02  RECNINI;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:NI,PT:NI,PT:NI:VA;0)  2.98150E+02  RECNINI;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI:NI:NI,PT:VA;0)  2.98150E+02  RECNINI;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI:NI,PT:NI:VA;0)  2.98150E+02  RECNINI;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:NI:NI:VA;0)  2.98150E+02  RECNINI;
  6.00000E+03   N  05LU !

   PARAMETER G(FCC_L12,PT:PT:NI,PT:NI,PT:VA;0)  2.98150E+02  RECPTPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI,PT:PT:NI,PT:VA;0)  2.98150E+02  RECPTPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI,PT:NI,PT:PT:VA;0)  2.98150E+02  RECPTPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:PT:PT:NI,PT:VA;0)  2.98150E+02  RECPTPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:PT:NI,PT:PT:VA;0)  2.98150E+02  RECPTPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:PT:PT:VA;0)  2.98150E+02  RECPTPT;
  6.00000E+03   N  05LU !

   PARAMETER G(FCC_L12,AL:AL:NI,PT:NI,PT:VA;0) 2.98150E+02 RECPTPT+VA74+VA75*T;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI,PT:AL:NI,PT:VA;0) 2.98150E+02 RECPTPT+VA74+VA75*T;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI,PT:NI,PT:AL:VA;0) 2.98150E+02 RECPTPT+VA74+VA75*T;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:AL:AL:NI,PT:VA;0) 2.98150E+02 RECPTPT+VA74+VA75*T;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:AL:NI,PT:AL:VA;0) 2.98150E+02 RECPTPT+VA74+VA75*T;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:AL:AL:VA;0) 2.98150E+02 RECPTPT+VA74+VA75*T;
  6.00000E+03   N  05LU !

   PARAMETER G(FCC_L12,NI:PT:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:NI,PT:PT:NI,PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI,PT:NI:NI,PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:NI,PT:NI,PT:PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI,PT:NI,PT:NI:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI:PT:NI,PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:PT:NI:NI,PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI:NI,PT:PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:PT:NI,PT:NI:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:NI:PT:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:PT:NI:VA;0)  2.98150E+02  RECNIPT;
  6.00000E+03   N  05LU !

   PARAMETER G(FCC_L12,NI,PT:NI,PT:AL:NI:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:NI:AL:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:AL:NI:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI:AL:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:AL:NI,PT:NI:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI:NI,PT:AL:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:AL:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI,PT:NI,PT:NI:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:NI,PT:NI,PT:AL:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI,PT:NI:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI:NI,PT:AL:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA76;
  6.00000E+03   N  05LU !

   PARAMETER G(FCC_L12,NI,PT:NI,PT:AL:PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:NI,PT:PT:AL:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:AL:PT:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:PT:AL:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:AL:NI,PT:PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,NI,PT:PT:NI,PT:AL:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:PT:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:AL:NI,PT:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI,PT:NI,PT:PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI,PT:NI,PT:AL:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,AL:NI,PT:PT:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !
   PARAMETER G(FCC_L12,PT:NI,PT:AL:NI,PT:VA;0)  2.98150E+02  RECNIPT+VA77;
  6.00000E+03   N  05LU !

   PARAMETER G(FCC_L12,AL,NI:AL,PT:*:*:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,PT:AL,NI:*:*:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,NI:*:AL,PT:*:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,PT:*:AL,NI:*:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,NI:*:*:AL,PT:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,PT:*:*:AL,NI:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,NI:AL,PT:*:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,PT:AL,NI:*:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:AL,NI:AL,PT:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:AL,PT:AL,NI:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,NI:*:AL,PT:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,PT:*:AL,NI:VA;0) 2.9815E+02  LALNIALPT;
6E+03 N 05LU !

   PARAMETER G(FCC_L12,AL,NI:NI,PT:*:*:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI,PT:AL,NI:*:*:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,NI:*:NI,PT:*:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI,PT:*:AL,NI:*:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,NI:*:*:NI,PT:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI,PT:*:*:AL,NI:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:AL,NI:NI,PT:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:NI,PT:AL,NI:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,NI:*:NI,PT:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:NI,PT:*:AL,NI:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,NI:NI,PT:*:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:NI,PT:AL,NI:*:VA;0) 2.9815E+02  LALNINIPT;
6E+03 N 05LU !

   PARAMETER G(FCC_L12,AL,PT:NI,PT:*:*:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI,PT:AL,PT:*:*:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,PT:*:NI,PT:*:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI,PT:*:AL,PT:*:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,PT:*:*:NI,PT:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,NI,PT:*:*:AL,PT:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:AL,PT:NI,PT:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:NI,PT:AL,PT:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,PT:*:NI,PT:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:NI,PT:*:AL,PT:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,PT:NI,PT:*:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:NI,PT:AL,PT:*:VA;0) 2.9815E+02  LALPTNIPT;
6E+03 N 05LU !

   PARAMETER G(FCC_L12,AL,NI,PT:AL,NI,PT:*:*:VA;0) 2.9815E+02
         VA80+VA81*T; 6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,NI,PT:*:AL,NI,PT:*:VA;0) 2.9815E+02
         VA80+VA81*T; 6E+03 N 05LU !
   PARAMETER G(FCC_L12,AL,NI,PT:*:*:AL,NI,PT:VA;0) 2.9815E+02
         VA80+VA81*T; 6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,NI,PT:AL,NI,PT:*:VA;0) 2.9815E+02
         VA80+VA81*T; 6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:AL,NI,PT:*:AL,NI,PT:VA;0) 2.9815E+02
         VA80+VA81*T; 6E+03 N 05LU !
   PARAMETER G(FCC_L12,*:*:AL,NI,PT:AL,NI,PT:VA;0) 2.9815E+02
         VA80+VA81*T; 6E+03 N 05LU !
$***********AL3NI1
 PHASE AL3NI1  %  2 .75   .25 !
    CONSTITUENT AL3NI1  :AL : NI :  !

   PARAMETER G(AL3NI1,AL:NI;0)  2.98150E+02  -48483.73+12.29913*T
  +.75*GHSERAL#+.25*GHSERNI#;   6.00000E+03   N 95DUP3   !

$******************** AL3NI2

 PHASE AL3NI2  %  3 3   2   1 !
    CONSTITUENT AL3NI2  :AL : AL,NI%,PT : NI,VA% :  !

   PARAMETER G(AL3NI2,AL:AL:NI;0)  298.15  +6*GALALNI;,,     N  95DUP3 !
   PARAMETER G(AL3NI2,AL:NI:NI;0)  298.15  +6*GALNINI;,,     N  95DUP3 !
   PARAMETER G(AL3NI2,AL:AL:VA;0)  298.15  +6*GALALVA;,,     N  95DUP3 !
   PARAMETER G(AL3NI2,AL:NI:VA;0)  298.15  +6*GALNIVA;,,     N  95DUP3 !

   PARAMETER G(AL3NI2,AL:PT:NI;0)  2.98150E+02  +3*GBCCAL#+GBCCNI#+2*GBCCPT#
  +VA60+VA61*T;   6.00000E+03   N  05LU !
   PARAMETER G(AL3NI2,AL:PT:VA;0)  2.98150E+02  VA62+VA63*T
  +3*GBCCAL#+2*GBCCPT#;   6.00000E+03  N 05LU  !

   PARAMETER L(AL3NI2,AL:AL,NI:*;0)  298.15  +6*L32ALNI;,,     N 95DUP3  !
   PARAMETER L(AL3NI2,AL:*:NI,VA;0)  298.15  +6*L32NIVA;,,     N 95DUP3  !

   PARAMETER G(AL3NI2,AL:NI,PT:*;0)  2.98150E+02  VA64+VA65*T;
  6.00000E+03   N 05LU !
   PARAMETER G(AL3NI2,AL:AL,PT:*;0)  2.98150E+02  VA66+VA67*T;
  6.00000E+03   N 05LU !

$******************** AL3NI5

 PHASE AL3NI5  %  2 .375   .625 !
    CONSTITUENT AL3NI5  :AL : NI :  !

   PARAMETER G(AL3NI5,AL:NI;0)  298.15  -66520+18.9*T
                                +.375*GHSERAL+.625*GHSERNI;,,   N 03SUN !

$   PARAMETER G(AL3NI5,AL:NI;0)  2.98150E+02  +.375*GHSERAL#+.625*GHSERNI#
$  -55507.7594+7.2648103*T;   6.00000E+03   N 95DUP3   !

$***************************** BCC_A2

 FUNCTION B2ORDER   298.15  0.5*B2ALPT-0.5*LB2ALPT;   6000.0   N !
 FUNCTION L0A2ALPT  298.15  B2ALPT+LB2ALPT;   6000.0   N !


$****************** BCC_B2
 PHASE BCC_B2  % 3 .5   .5   3 !
    CONSTITUENT BCC_B2  :AL,NI%,PT,VA : AL%,NI,PT,VA : VA :  !

  PARA G(BCC_B2,AL:AL:VA;0) 298.15 +GBCCAL; 6000 N 91DIN !
  PARA G(BCC_B2,NI:NI:VA;0) 298.15 +GBCCNI; 6000 N  91DIN !
  PARA G(BCC_B2,PT:PT:VA;0) 298.15 +GBCCPT; 6000 N  91DIN !
  PARA G(BCC_B2,VA:VA:VA;0) 298.15 0; 6000 N !
 PARAMETER TC(BCC_B2,NI:VA:VA;0)  298.15  575;,, N 89DIN !
 PARAMETER BMAGN(BCC_B2,NI:VA:VA;0)  298.15  .85;,, N 89DIN !

   FUNCTION B2ALNI 295.15 -152397.3+26.40575*T;,, N 95DUP3 !
PARA G(BCC_B2,NI:AL:VA;0) 2.9815E+02 +.5*GBCCAL+.5*GBCCNI+.5*B2ALNI;
6000 N 95DUP3 !
PARA G(BCC_B2,AL:NI:VA;0) 2.9815E+02 +.5*GBCCAL+.5*GBCCNI+.5*B2ALNI;
6000 N 95DUP3 !

   FUNCTION B2ALVA 295.15 10000-T;,,N  95DUP3 !
PARA G(BCC_B2,VA:AL:VA;0) 2.9815E+02 +0.5*GBCCAL+.5*B2ALVA; 6000 N 95DUP3 !
PARA G(BCC_B2,AL:VA:VA;0) 2.9815E+02 +0.5*GBCCAL+.5*B2ALVA; 6000 N 95DUP3 !

   PARAMETER G(BCC_B2,AL:PT:VA;0)  2.98150E+02  +.5*GALBCC#+.5*GPTBCC#
  +.5*B2ALPT#;   6.00000E+03   N REF11 !
   PARAMETER G(BCC_B2,PT:AL:VA;0)  2.98150E+02  +.5*GALBCC#+.5*GPTBCC#
  +.5*B2ALPT#;   6.00000E+03   N REF11 !

   FUNCTION B2NIVA 295.15 +162397.3-27.40575*T;,, N 95DUP3 !
PARA G(BCC_B2,VA:NI:VA;0) 2.9815E+02  +.5*GBCCNI+.5*B2NIVA; 6000 N 95DUP3 !
PARA G(BCC_B2,NI:VA:VA;0) 2.9815E+02  +.5*GBCCNI+.5*B2NIVA; 6000 N 95DUP3 !

PARA G(BCC_B2,PT:NI:VA;0) 2.9815E+02  +.5*GBCCNI+.5*GBCCPT+VA93+VA94*T;
  6000 N 05LU !
PARA G(BCC_B2,NI:PT:VA;0) 2.9815E+02  +.5*GBCCNI+.5*GBCCPT+VA93+VA94*T;
  6000 N 05LU !

   PARAMETER G(BCC_B2,PT:VA:VA;0)  2.98150E+02  +.5*GPTBCC#+.5*B2PTVA#;
  6.00000E+03   N REF11 !
   PARAMETER G(BCC_B2,VA:PT:VA;0)  2.98150E+02  +.5*GPTBCC#+.5*B2PTVA#;
  6.00000E+03   N REF11 !

   FUNCTION LB2ALNI 298.15 -62104+19.28*T;,, N 03SUN !
PARA G(BCC_B2,*:AL,NI:VA;0) 2.9815E+02  +.5*LB2ALNI; 6000  N 95DUP3 !
PARA G(BCC_B2,AL,NI:*:VA;0) 2.9815E+02  +.5*LB2ALNI; 6000  N 95DUP3 !

   FUNCTION LB2ALVA 298.15 200000;,,N  !
PARA G(BCC_B2,*:AL,VA:VA;0) 2.9815E+02  +.5*LB2ALVA; 6000  N 95DUP3 !
PARA G(BCC_B2,AL,VA:*:VA;0) 2.9815E+02  +.5*LB2ALVA; 6000  N 95DUP3 !

   FUNCTION LB2NIVA 298.15 -64024.38+26.49419*T;,, N !
PARA G(BCC_B2,*:NI,VA:VA;0) 2.9815E+02  +.5*LB2NIVA; 6000  N 95DUP3 !
PARA G(BCC_B2,NI,VA:*:VA;0) 2.9815E+02  +.5*LB2NIVA; 6000  N 95DUP3 !


PARA G(BCC_B2,*:NI,PT:VA;0) 2.9815E+02  +VA87+VA88*T; 6000  N 05LU !
PARA G(BCC_B2,NI,PT:*:VA;0) 2.9815E+02  +VA87+VA88*T; 6000  N 05LU !


   PARAMETER G(BCC_B2,*:PT,VA:VA;0)  2.98150E+02  +.5*LB2PTVA#;
  6.00000E+03   N REF11 !
   PARAMETER G(BCC_B2,PT,VA:*:VA;0)  2.98150E+02  +.5*LB2PTVA#;
  6.00000E+03   N REF11 !

   PARAMETER G(BCC_B2,AL,PT:AL:VA;0)  2.98150E+02
   -0.5*B2ORDER+0.25*L0A2ALPT+0.375*L1A2ALPT;
  6.00000E+03   N REF11 !
   PARAMETER G(BCC_B2,AL:AL,PT:VA;0)  2.98150E+02
   -0.5*B2ORDER+0.25*L0A2ALPT+0.375*L1A2ALPT;
  6.00000E+03   N REF11 !

   PARAMETER G(BCC_B2,AL,PT:PT:VA;0)  2.98150E+02
   -0.5*B2ORDER+0.25*L0A2ALPT-0.375*L1A2ALPT;
  6.00000E+03   N REF11 !
   PARAMETER G(BCC_B2,PT:AL,PT:VA;0)  2.98150E+02
   -0.5*B2ORDER+0.25*L0A2ALPT-0.375*L1A2ALPT;
  6.00000E+03   N REF11 !

   PARAMETER G(BCC_B2,AL,PT:*:VA;1)  2.98150E+02  +0.125*L1A2ALPT;
  6.00000E+03   N REF11 !
   PARAMETER G(BCC_B2,*:AL,PT:VA;1)  2.98150E+02  +0.125*L1A2ALPT;
  6.00000E+03   N REF11 !

$******************************** Compounds in AL-Pt

$  PHASE AL21PT8 % 2 .724138 .275862 !
$      CONS AL21PT8 :AL:PT NI:!
$  PARAMETER G(AL21PT8,AL:NI;0)  2.98150E+02 -35000+.724138*GHSERAL#
$    +.275862*GHSERNI#;   6.00000E+03   N REF: 0 !

$   PARAMETER G(AL21PT8,AL:PT;0)  298.15  -82342+23.7*T+.7242*GHSERAL#
$  +.2759*GHSERPT#;   6000   N REF0 !

  PHASE ALPT % 2 .5 .5 !
  CONS ALPT :AL:PT NI:!
  PARAMETER G(ALPT,AL:NI;0)  2.98150E+02 VA70+VA71*T+.5*GHSERAL#+.5*GHSERNI#;
     6.00000E+03   N REF: 0 !
  PARAMETER G(ALPT,AL:NI,PT;0)  2.98150E+02  VA72+VA73*T;   6.00000E+03
     N REF: 0 !
   PARAMETER G(ALPT,AL:PT;0)  298.15  +.5*GHSERAL#+.5*GHSERPT#+VX85#
  +VX95#*T;   6000.0   N REF0 !
$*******************

 PHASE PT2AL  %  2 .3333   .6667 !
    CONSTITUENT PT2AL  :AL : PT :  !

   PARAMETER G(PT2AL,AL:PT;0)  298.15  +.3333*GHSERAL#+.6667*GHSERPT#
  -84137+VX90#*T;   6000.0   N REF0 !


 PHASE PT2AL3  %  2 .6   .4 !
    CONSTITUENT PT2AL3  :AL : PT :  !

   PARAMETER G(PT2AL3,AL:PT;0)  298.15  +.6*GHSERAL#+.4*GHSERPT#-98234
  +VX91#*T;   6000.0   N REF0 !


 PHASE PT5AL21  %  2 .8077   .1923 !
    CONSTITUENT PT5AL21  :AL : PT :  !

   PARAMETER G(PT5AL21,AL:PT;0)  298.15  +.8077*GHSERAL#+.1923*GHSERPT#
  -53148+VX92#*T;   6000.0   N REF0 !


 PHASE PT5AL3  %  2 .375   .625 !
    CONSTITUENT PT5AL3  :AL : PT :  !

   PARAMETER G(PT5AL3,AL:PT;0)  298.15  +.375*GHSERAL#+.625*GHSERPT#
  -88904+VX93#*T;   6000.0   N REF0 !


 PHASE PT8AL21  %  2 .7241   .2759 !
    CONSTITUENT PT8AL21  :AL : PT :  !

   PARAMETER G(PT8AL21,AL:PT;0)  298.15  +.7241*GHSERAL#+.2759*GHSERPT#
  -74851+VX94#*T;   6000.0   N REF0 !


 PHASE ALPT2  %  2 .6667   .3333 !
    CONSTITUENT ALPT2  :AL : PT :  !

   PARAMETER G(ALPT2,AL:PT;0)  298.15  +.6667*GHSERAL#+.3333*GHSERPT#
  -89614+VX96#*T;   6000.0   N REF0 !
$*************************************
$ASSESSED_SYSTEM AL-NI(;P3 STP:.8/1200/1) !


 LIST_OF_REFERENCES
 NUMBER  SOURCE
   REF01  'Kaisheng WU and Zhanpeng JIN, J. Phase Equil., Vol.21(3), 2000'
   REF02  'P.Nash and M.F.Singleton, Bulletin of Alloy Phase Diagrams,
           Vol.10(3),1989'
   REF283   'Alan Dinsdale, SGTE Data for Pure Elements,
          Calphad Vol 15(1991) p 317-425,
          also in NPL Report DMA(A)195 Rev. August 1990'
  91DIN    'Alan Dinsdale, SGTE Data for Pure Elements, Calphad Vol 15(1991)
         p 317-425, also in NPL Report DMA(A)195 Rev. August 1990'
   REF95    'I Ansara, P Willemin B Sundman (1988); Al-Ni'
   REF295   'N. Saunders, unpublished research, COST-507, (1991); Al-Cu'
   REF281   'Alan Dinsdale, SGTE Data for Pure Elements, NPL Report
         DMA(A)195
          September 1989'
  89DIN    'Alan Dinsdale, SGTE Data for Pure Elements, NPL Report DMA(A)195
         September 1989'
   REF26    'A. Fernandez Guillermet, Z. Metallkde. Vol 79(1988) p.524-536,
          TRITA-MAC 362 (1988); C-CO-NI AND C-CO-FE-NI'
   REF293   'N. Saunders, private communication (1991); Al-Ti-V'
  95DUP3   'N. Dupin, Thesis, LTPCM, France, 1995; Al-Ni, also in I. Ansara,
         N. Dupin, H.L. Lukas, B. Sundman J. Alloys Compds, 247 (1-2), 20-30
         (1997)'
  99DUP    'N. Dupin, I. Ansara, Z. metallkd., Vol 90 (1999) p 76-85; Al-Ni'
  99DUP3   'N. Dupin, July 1999, unpublished revision ; Al-Ni'
  03SUN     'B. Sundman, N. Dupin, JEEP 2003 Lyon'
  REF0 'S Prins and B Sundman, provisional Al-Pt (2003)'
  05LU     'X.-G Lu, PhD thesis work, unpublished'
 !
"""

ROSE_TEST_STRING = """
ELEMENT H                 TEST    0      0    0  !
ELEMENT HE                TEST    0      0    0  !
ELEMENT LI                TEST    0      0    0  !
ELEMENT BE                TEST    0      0    0  !
ELEMENT B                 TEST    0      0    0  !
ELEMENT C                 TEST    0      0    0  !
ELEMENT N                 TEST    0      0    0  !
ELEMENT O                 TEST    0      0    0  !
ELEMENT F                 TEST    0      0    0  !
ELEMENT NE                TEST    0      0    0  !

TYPE_DEFINITION % SEQ * !
FUNCTION STR 300 200000; 6000 N !

 PHASE TEST % 1 1 !
 CONSTITUENT TEST : H,HE,LI,BE,B,C,N,O,F,NE : !

PARAMETER G(TEST,H,HE,LI;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,LI;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,LI;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,BE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,BE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,BE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,B;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,B;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,B;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,HE,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,BE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,BE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,BE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,B;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,B;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,B;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,LI,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,B;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,B;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,B;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,BE,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,B,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,C,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,N,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,H,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,H,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,H,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,BE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,BE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,BE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,B;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,B;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,B;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,LI,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,B;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,B;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,B;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,BE,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,B,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,C,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,N,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,HE,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,B;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,B;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,B;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,BE,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,B,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,C,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,N,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,LI,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,C;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,C;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,C;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,B,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,C,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,N,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,BE,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,N;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,N;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,N;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,C,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,N,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,B,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,B,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,B,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,O;0)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,O;1)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,O;2)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,C,N,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,C,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,C,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,C,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,C,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,C,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,C,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,C,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,C,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,C,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,N,O,F;0)     300  STR#;               6000 N !
PARAMETER G(TEST,N,O,F;1)     300  STR#;               6000 N !
PARAMETER G(TEST,N,O,F;2)     300  STR#;               6000 N !
PARAMETER G(TEST,N,O,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,N,O,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,N,O,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,N,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,N,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,N,F,NE;2)     300  STR#;               6000 N !
PARAMETER G(TEST,O,F,NE;0)     300  STR#;               6000 N !
PARAMETER G(TEST,O,F,NE;1)     300  STR#;               6000 N !
PARAMETER G(TEST,O,F,NE;2)     300  STR#;               6000 N !
"""

ROSE_DBF = Database(ROSE_TEST_STRING)
ALFE_DBF = Database('examples/alfe_sei.TDB')

# ROSE DIAGRAM TESTS
# This will fail until the equilibrium engine is switched from Newton-Raphson
@SkipTest
def test_rose_nine():
    "Nine-component rose diagram point equilibrium calculation."
    my_phases_rose = ['TEST']
    comps = ['H', 'HE', 'LI', 'BE', 'B', 'C', 'N', 'O', 'F']
    conds = dict({v.T: 1000, v.P: 101325})
    for comp in comps[:-1]:
        conds[v.X(comp)] = 1.0/float(len(comps))
    eqx = equilibrium(ROSE_DBF, comps, my_phases_rose, conds)
    assert_allclose(eqx.GM.values, -5.8351e3)

# OTHER TESTS
def test_eq_binary():
    "Binary phase diagram point equilibrium calculation with magnetism."
    my_phases = ['LIQUID', 'FCC_A1', 'HCP_A3', 'AL5FE2',
                 'AL2FE', 'AL13FE4', 'AL5FE4']
    comps = ['AL', 'FE', 'VA']
    conds = {v.T: 1400, v.P: 101325, v.X('AL'): 0.55}
    eqx = equilibrium(ALFE_DBF, comps, my_phases, conds)
    # Why is this very low tolerance required for the test to pass on py33?
    assert_allclose(eqx.GM.values, -9.608807e4, atol=0.1)

def test_eq_single_phase():
    "Equilibrium energy should be the same as for a single phase with no miscibility gaps."
    res = calculate(ALFE_DBF, ['AL', 'FE'], 'LIQUID', T=[1400, 2500], P=101325,
                    points={'LIQUID': [[0.1, 0.9], [0.2, 0.8], [0.3, 0.7],
                                       [0.4, 0.6], [0.5, 0.5], [0.6, 0.4],
                                       [0.7, 0.3], [0.8, 0.2]]})
    eq = equilibrium(ALFE_DBF, ['AL', 'FE'], 'LIQUID',
                     {v.T: [1400, 2500], v.P: 101325,
                      v.X('AL'): [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8]})
    assert_allclose(eq.GM, res.GM, atol=1e-4)


def test_eq_b2_without_all_comps():
    """
    All-vacancy endmembers are correctly excluded from the computation when fewer than
    all components in a Database are selected for the calculation.
    """
    equilibrium(Database(ALNIPT_TDB), ['AL', 'NI', 'VA'], 'BCC_B2', {v.X('NI'): 0.4, v.P: 101325, v.T: 1200})


@raises(ValueError)
def test_eq_underdetermined_comps():
    """
    The number of composition conditions should yield exactly one dependent component.
    This is the underdetermined case.
    """
    equilibrium(ALFE_DBF, ['AL', 'FE'], 'LIQUID', {v.T: 2000, v.P: 101325})


@raises(ValueError)
def test_eq_overdetermined_comps():
    """
    The number of composition conditions should yield exactly one dependent component.
    This is the overdetermined case.
    """
    equilibrium(ALFE_DBF, ['AL', 'FE'], 'LIQUID', {v.T: 2000, v.P: 101325,
                                                   v.X('FE'): 0.2, v.X('AL'): 0.8})


def test_eq_composition_cond_sorting():
    """
    Composition conditions are correctly constructed when the dependent component does not
    come last in alphabetical order (gh-21).
    """
    eq = equilibrium(ALFE_DBF, ['AL', 'FE'], 'LIQUID',
                     {v.T: 2000, v.P: 101325, v.X('FE'): 0.2})
    # Values computed by Thermo-Calc
    tc_energy = -143913.3
    tc_mu_fe = -184306.01
    tc_mu_al = -133815.12
    assert_allclose(eq.GM.values, tc_energy)
    assert_allclose(eq.MU.values, [[[[tc_mu_al, tc_mu_fe]]]], rtol=1e-6)

if __name__ == '__main__':
    import nose
    nose.run(defaultTest=__name__)
